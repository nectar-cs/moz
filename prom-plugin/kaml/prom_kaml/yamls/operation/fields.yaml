kind: Field
id: access_type
config_space: nmachine.prom
title: Where is the Prometheus server located?
input: kind::SelectInput
options:
  - id: kubernetes
    title: Inside the cluster
  - id: generic
    title: Outside the cluster

---

kind: Field
id: url
title: Data Source API's Base URL
config_space: nmachine.prom
visible:
  kind: Predicate
  challenge: get::props inputs->.access_type
  check_against: generic
validators:
  - kind: FormatPredicate
    check_against: domain
    challenge: get::props inputs->.url

---

kind: Field
id: service_namespace
title: Namespace containing Prometheus Operator
config_space: nmachine.prom
visible:
  kind: Predicate
  challenge: get::props inputs->.access_type
  check_against: kubernetes
variable:
  id: monitoring.service_namespace
  default: get::ns
  input:
    kind: SelectInput
    options:
      kind: ResourcesSupplier
      selector: "expr::Namespace:*"
      many: true
      output: options_format
      serializer: legacy

---

kind: Field
id: service_name
title: Prometheus Operator Service
config_space: nmachine.prom
visible:
  kind: Predicate
  challenge: get::props inputs->.service_namespace
  operator: presence
input:
  kind: SelectInput
  options:
    kind: ResourcesSupplier
    many: true
    selector:
      res_kind: Service
      namespace: "get::props inputs->.service_namespace"
    output: options_format
    serializer: legacy